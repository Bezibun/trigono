<!DOCTYPE html>
<html lang="id" class="transition-colors duration-500">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Modul Trigonometri</title>
  <link rel="icon" type="image/png" href="source/foto/logo.png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
  <script> tailwind.config = { darkMode: 'class' } </script>
  <style>
    html {
      transition: background-color 0.4s ease, color 0.4s ease;
    }
    @keyframes fadeInUp {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    .animate-fadeInUp { animation: fadeInUp 0.8s ease forwards; }
  </style>
</head>

<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen transition-colors duration-500">

 <nav class="fixed top-6 left-1/2 -translate-x-1/2 bg-white dark:bg-gray-800 text-black dark:text-white px-6 py-3 rounded-full shadow-lg flex items-center justify-between w-[90%] md:w-[70%] lg:w-[60%] z-50 transition-all duration-300">
  
  <!-- Logo -->
  <div class="flex items-center space-x-2">
    <div class="bg-white dark:bg-gray-700 p-2 rounded-full shadow-md flex items-center justify-center">
      <img src="source/foto/logo.png" alt="Logo" class="w-8 h-8 object-contain">
    </div>
  </div>

  <!-- Menu (Desktop) -->
  <ul class="hidden md:flex space-x-8 text-sm font-medium">
    <li><a href="index.html" class="text-blue-600 dark:text-blue-400 font-semibold border-b-2 border-blue-600 dark:border-blue-400 pb-1 transition">Beranda</a></li>
    <li><a href="materi.html" class="hover:text-blue-600 dark:hover:text-blue-400 transition">Materi</a></li>
    <li><a href="latihan.html" class="hover:text-blue-600 dark:hover:text-blue-400 transition">Latihan</a></li>
    <li><a href="games.html" class="hover:text-blue-600 dark:hover:text-blue-400 transition">Games</a></li>
    <li><a href="informasi.html" class="hover:text-blue-600 dark:hover:text-blue-400 transition">Informasi</a></li>
  </ul>

  <!-- Right Section (Desktop) -->
  <div class="hidden md:flex items-center space-x-3">
    <!-- Dark Mode -->
    <button id="theme-toggle" class="p-2 rounded-full bg-blue-700 dark:bg-gray-600 text-white focus:outline-none transition">
      <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M12 3v1m0 16v1m8.66-8.66h-1M4.34 12H3m15.07 6.07l-.7-.7M6.34 6.34l-.7-.7m12.02 0l-.7.7M6.34 17.66l-.7.7M12 8a4 4 0 100 8 4 4 0 000-8z" />
      </svg>
      <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M21 12.79A9 9 0 1111.21 3a7 7 0 009.79 9.79z" />
      </svg>
    </button>

    <!-- Profil -->
    <div class="relative">
      <button id="profileBtn" class="flex items-center focus:outline-none">
        <img id="navProfilePic" src="https://cdn-icons-png.flaticon.com/512/149/149071.png"
          class="w-9 h-9 rounded-full border-2 border-blue-600 object-cover">
      </button>

      <div id="profileDropdown" class="hidden absolute right-0 mt-3 w-56 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-3">
        <div class="flex flex-col items-center">
          <div class="relative">
            <img id="profilePic" src="https://cdn-icons-png.flaticon.com/512/149/149071.png"
              class="w-16 h-16 rounded-full border-2 border-blue-500 object-cover">
            <label for="fileInput" class="absolute bottom-1 right-1 bg-blue-600 text-white p-1 rounded-full cursor-pointer">
              <i class="bx bx-edit-alt text-sm"></i>
            </label>
            <input id="fileInput" type="file" accept="image/*" class="hidden">
          </div>
          <div class="text-center">
            <h3 id="usernameDisplay" class="font-semibold p-2 text-gray-900 dark:text-white"></h3>
            <button id="logoutBtn" class="bg-blue-600 px-3 py-1 mt-2 rounded-md text-white flex items-center gap-1 justify-center">
              <i class="fa-solid fa-right-from-bracket"></i> Logout
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

<!-- Right Section (Mobile) -->
<div class="flex md:hidden items-center space-x-3">
  <!-- Toggle Dark Mode -->
  <button id="theme-toggle-mobile" class="p-2 rounded-full bg-blue-700 dark:bg-gray-600 text-white focus:outline-none transition">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
        d="M21 12.79A9 9 0 1111.21 3a7 7 0 009.79 9.79z" />
    </svg>
  </button>

  <!-- Profile (Mobile) -->
  <div class="relative">
    <button id="profileBtnMobile" class="flex items-center focus:outline-none">
      <img id="navProfilePicMobile" src="https://cdn-icons-png.flaticon.com/512/149/149071.png"
        class="w-9 h-9 rounded-full border-2 border-blue-600 object-cover">
    </button>

    <!-- Dropdown Mobile -->
    <div id="profileDropdownMobile" class="hidden absolute right-0 mt-3 w-56 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-3 z-50">
      <div class="flex flex-col items-center">
        <div class="relative">
          <img id="profilePicMobile" src="https://cdn-icons-png.flaticon.com/512/149/149071.png"
            class="w-16 h-16 rounded-full border-2 border-blue-500 object-cover">
          <label for="fileInputMobile" class="absolute bottom-1 right-1 bg-blue-600 text-white p-1 rounded-full cursor-pointer">
            <i class="bx bx-edit-alt text-sm"></i>
          </label>
          <input id="fileInputMobile" type="file" accept="image/*" class="hidden">
        </div>
        <div class="text-center">
          <h3 id="usernameDisplayMobile" class="font-semibold p-2 text-gray-900 dark:text-white"></h3>
          <button id="logoutBtnMobile" class="bg-blue-600 px-3 py-1 mt-2 rounded-md text-white flex items-center gap-1 justify-center">
            <i class="fa-solid fa-right-from-bracket"></i> Logout
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Menu Button -->
  <button id="menu-btn" class="flex items-center focus:outline-none">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-black dark:text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
    </svg>
  </button>
</div>

</nav>





  <!-- Hero -->
  <section class="relative flex flex-col items-center justify-center min-h-screen bg-gradient-to-b from-white to-blue-50 dark:from-gray-900 dark:to-gray-800 overflow-hidden transition-colors duration-500">
    <div class="absolute inset-0">
      <div class="absolute w-72 h-72 bg-blue-200 dark:bg-blue-900 rounded-full blur-3xl opacity-30 -top-20 -left-20 animate-pulse"></div>
      <div class="absolute w-96 h-96 bg-blue-300 dark:bg-blue-950 rounded-full blur-3xl opacity-30 bottom-0 right-0 animate-pulse"></div>
    </div>

    <div class="relative text-center px-6 mt-20 animate-fadeInUp">
      <h1 class="text-4xl md:text-6xl font-bold text-blue-800 dark:text-blue-400 mb-4">
        Selamat Datang<br>
        <span id="username" class="text-blue-600 dark:text-blue-300">User</span>
      </h1>
      <p class="text-gray-700 dark:text-gray-300 max-w-2xl mx-auto text-lg md:text-xl mb-8"> Practice makes perfect. Be patient. Success in learning is a marathon, not a sprint. </p>
      <a href="stroytelling.html"
        class="bg-blue-600 dark:bg-blue-500 text-white px-6 py-3 rounded-full text-lg font-semibold hover:bg-blue-700 dark:hover:bg-blue-400 transition duration-300">
        Mulai Belajar
      </a>
    </div>
  </section>

<style>
  /* Tambahan biar dropdown mobile nongol di atas */
  #profileDropdownMobile {
    position: absolute;
    right: 0;
    top: 100%;
    z-index: 9999;
  }

  #profileBtnMobile {
    z-index: 10000;
    position: relative;
  }
</style>


<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
  import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

  // === ðŸ”¥ FIREBASE CONFIG ===
  const firebaseConfig = {
    apiKey: "AIzaSyCeJMh6W7I3yVDQqEJQzw8CegsD8NYEVU4",
    authDomain: "modul-trigono.firebaseapp.com",
    projectId: "modul-trigono",
    storageBucket: "modul-trigono.appspot.com",
    messagingSenderId: "980014540419",
    appId: "1:980014540419:web:86285499e9fe06c823ddb6",
    measurementId: "G-NWLCNBXEQ6"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

// === ðŸ‘¤ CEK LOGIN & USERNAME ===
onAuthStateChanged(auth, async (user) => {
  const usernameDisplay = document.getElementById("usernameDisplay");
  const usernameDisplayMobile = document.getElementById("usernameDisplayMobile");
  const usernameHero = document.getElementById("username");

  if (!user) {
    setTimeout(() => (window.location.href = "login.html"), 500);
    return;
  }

  try {
    const userDoc = await getDoc(doc(db, "users", user.uid));
    const username = userDoc.exists()
      ? userDoc.data().username || user.email.split('@')[0]
      : user.email.split('@')[0];

    // Update semua tampilan username
    [usernameDisplay, usernameDisplayMobile, usernameHero].forEach((el) => {
      if (el) el.textContent = username;
    });

    localStorage.setItem("username", username);
  } catch (err) {
    console.error("Gagal memuat username:", err);
    const fallback = user.email.split('@')[0];
    [usernameDisplay, usernameDisplayMobile, usernameHero].forEach((el) => {
      if (el) el.textContent = fallback;
    });
  }
});

  // === ðŸŒ™ DARK MODE (Desktop & Mobile) ===
  const themeToggleDesktop = document.getElementById("theme-toggle");
  const themeToggleMobile = document.getElementById("theme-toggle-mobile");
  const sunIcon = document.getElementById("sun-icon");
  const moonIcon = document.getElementById("moon-icon");

  const setTheme = (dark) => {
    document.documentElement.classList.toggle("dark", dark);
    localStorage.setItem("theme", dark ? "dark" : "light");
    if (sunIcon && moonIcon) {
      sunIcon.classList.toggle("hidden", !dark);
      moonIcon.classList.toggle("hidden", dark);
    }
  };

  const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
  const isDark = localStorage.getItem("theme") === "dark" || (!localStorage.getItem("theme") && prefersDark);
  setTheme(isDark);

  const toggleThemeHandler = () => setTheme(!document.documentElement.classList.contains("dark"));
  themeToggleDesktop?.addEventListener("click", toggleThemeHandler);
  themeToggleMobile?.addEventListener("click", toggleThemeHandler);

  // === ðŸ“± MENU HAMBURGER ===
  const menuBtn = document.getElementById("menu-btn");
  const mobileMenu = document.getElementById("mobile-menu");
  if (menuBtn && mobileMenu) {
    menuBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      mobileMenu.classList.toggle("hidden");
    });
    document.addEventListener("click", (e) => {
      if (!mobileMenu.contains(e.target) && !menuBtn.contains(e.target)) {
        mobileMenu.classList.add("hidden");
      }
    });
  }

  // === ðŸ‘¤ PROFIL (Desktop & Mobile) ===
  const profileBtn = document.getElementById("profileBtn");
  const profileBtnMobile = document.getElementById("profileBtnMobile");
  const dropdown = document.getElementById("profileDropdown");
  const dropdownMobile = document.getElementById("profileDropdownMobile");
  const fileInput = document.getElementById("fileInput");
  const fileInputMobile = document.getElementById("fileInputMobile");
  const profilePic = document.getElementById("profilePic");
  const profilePicMobile = document.getElementById("profilePicMobile");
  const navProfilePic = document.getElementById("navProfilePic");
  const navProfilePicMobile = document.getElementById("navProfilePicMobile");
  const logoutBtn = document.getElementById("logoutBtn");
  const logoutBtnMobile = document.getElementById("logoutBtnMobile");

  // === Dropdown Desktop ===
  if (profileBtn && dropdown) {
    profileBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      dropdown.classList.toggle("hidden");
    });
    document.addEventListener("click", (e) => {
      if (!dropdown.contains(e.target) && !profileBtn.contains(e.target)) {
        dropdown.classList.add("hidden");
      }
    });
  }

  // === Dropdown Mobile (FIX) ===
  if (profileBtnMobile && dropdownMobile) {
    profileBtnMobile.addEventListener("click", (e) => {
      e.stopPropagation();
      dropdownMobile.classList.toggle("hidden");
    });

    // Tutup dropdown kalau klik di luar
    document.addEventListener("click", (e) => {
      if (!dropdownMobile.contains(e.target) && !profileBtnMobile.contains(e.target)) {
        dropdownMobile.classList.add("hidden");
      }
    });
  }

  // === Gambar Profil Lokal ===
  const savedPic = localStorage.getItem("profilePic");
  if (savedPic) {
    [profilePic, profilePicMobile, navProfilePic, navProfilePicMobile].forEach((img) => {
      if (img) img.src = savedPic;
    });
  }

  const handleFileUpload = (file, imgList) => {
    const reader = new FileReader();
    reader.onload = () => {
      imgList.forEach((img) => img && (img.src = reader.result));
      localStorage.setItem("profilePic", reader.result);
    };
    reader.readAsDataURL(file);
  };

  fileInput?.addEventListener("change", (e) => handleFileUpload(e.target.files[0], [profilePic, navProfilePic, profilePicMobile, navProfilePicMobile]));
  fileInputMobile?.addEventListener("change", (e) => handleFileUpload(e.target.files[0], [profilePic, navProfilePic, profilePicMobile, navProfilePicMobile]));

  // === Logout (Desktop & Mobile) ===
  const handleLogout = async () => {
    await signOut(auth);
    localStorage.clear();
    window.location.replace("login.html");
  };
  logoutBtn?.addEventListener("click", handleLogout);
  logoutBtnMobile?.addEventListener("click", handleLogout);



</script>











</body>
</html>